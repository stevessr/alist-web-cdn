import{d as O,u as S,e as I,a5 as L,a as m,b7 as o,at as h,f as M,m as u,a4 as N,c3 as Y,c4 as k,c5 as w,c6 as p,a2 as r,aP as y,bf as D,c7 as Q,b1 as z,a$ as l,I as d,F as U,B as j,aj as _,as as f,c8 as a,x as Z,ap as v,V as b,v as $,bx as B,bd as P,n as R}from"./index.d35f9728.js";import{o as F}from"./index.9ac13c94.js";import{L as G}from"./index.37946fd8.js";const W=$('<img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI1MiIgaGVpZ2h0PSIxMjUyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8Zz4KICA8ZyBpZD0iIzcwYzZiZWZmIj4KICAgPHBhdGggaWQ9InN2Z18yIiBkPSJtNjM0LjM3LDEzOC4zOGMxMS44OCwtMS4zNiAyNC4yNSwxLjMgMzQuMTgsOC4wOWMxNC45Niw5LjY2IDI1LjU1LDI0LjQxIDM0LjQ5LDM5LjUxYzQwLjU5LDY4LjAzIDgxLjQ1LDEzNS45MSAxMjIuMDIsMjAzLjk2YzU0LjAyLDkwLjk5IDEwOC4wNiwxODEuOTcgMTYxLjk0LDI3My4wNmMzNy4yOCw2MyA3NC42NSwxMjUuOTYgMTEyLjE4LDE4OC44MmMyNC43Miw0MS45OSA1MC4yMSw4My41NCA3My44NCwxMjYuMTZjMTAuMTgsMTcuODQgMTUuNzcsMzguNDQgMTQuOTMsNTkuMDNjLTAuNTksMTUuOTIgLTMuNDgsMzIuMjggLTExLjg0LDQ2LjA4Yy0xMS43MywxOS40NiAtMzEuMzksMzMuMiAtNTIuNzEsNDAuMzZjLTExLjM3LDQuMDkgLTIzLjMsNi44NyAtMzUuNDMsNi44OWMtMTMyLjMyLC0wLjA1IC0yNjQuNjQsMC4wNCAtMzk2Ljk1LDAuMDNjLTExLjM4LC0wLjI5IC0yMi45NSwtMS42IC0zMy42MywtNS43MmMtNy44MSwtMy4zMyAtMTUuNSwtNy40MyAtMjEuNjEsLTEzLjQyYy0xMC40MywtMTAuMzIgLTE3LjE5LC0yNC45NiAtMTUuMzgsLTM5LjgzYzAuOTQsLTEwLjM5IDMuNDgsLTIwLjY0IDcuNzYsLTMwLjE2YzQuMTUsLTkuNzcgOS45OSwtMTguNjcgMTUuMDYsLTI3Ljk3YzIyLjEzLC0zOS40NyA0NS4zMSwtNzguMzUgNjkuNDIsLTExNi42NWM3LjcyLC0xMi4wNSAxNC40NCwtMjUuMDcgMjUuMTIsLTM0Ljg3YzExLjM1LC0xMC4zOSAyNS42LC0xOC41NCA0MS4yMSwtMTkuNmMxMi41NSwtMC41MiAyNC44OSwzLjgyIDM1LjM1LDEwLjU1YzExLjgsNi45MiAyMS4wOSwxOC40NCAyNC4yLDMxLjg4YzQuNDksMTcuMDEgLTAuMzQsMzQuODggLTcuNTUsNTAuNDJjLTguMDksMTcuNjUgLTE5LjYyLDMzLjY3IC0yNS44MSw1Mi4xOGMtMS4xMyw0LjIxIC0yLjY2LDkuNTIgMC40OCwxMy4yM2MzLjE5LDMgNy42Miw0LjE4IDExLjc3LDUuMjJjMTIsMi42NyAyNC4zOCwxLjk4IDM2LjU5LDIuMDZjNDUsLTAuMDEgOTAsMCAxMzUsMGM4LjkxLC0wLjE1IDE3LjgzLDAuMyAyNi43NCwtMC4yMmM2LjQzLC0wLjc0IDEzLjQ0LC0xLjc5IDE4LjQ0LC02LjI4YzMuMywtMi45MiAzLjcxLC03Ljg1IDIuNDYsLTExLjg1Yy0yLjc0LC04Ljg2IC03LjQ2LC0xNi45MyAtMTIuMTIsLTI0Ljg5Yy0xMTkuOTksLTIwNC45MSAtMjM5LjMxLC00MTAuMjIgLTM2MC41NiwtNjE0LjRjLTMuOTYsLTYuNTYgLTcuMzYsLTEzLjY4IC0xMy4wMywtMTguOThjLTIuOCwtMi42OSAtNi45NSwtNC4yMiAtMTAuNzcsLTMuMTFjLTMuMjUsMS4xNyAtNS40NSw0LjAzIC03LjYxLDYuNTdjLTUuMzQsNi44MSAtMTAuMTIsMTQuMDYgLTE0LjUxLDIxLjUyYy0yMC44OSwzMy45NSAtNDAuODgsNjguNDQgLTYxLjM1LDEwMi42NGMtMTE3LjksMTk4LjQzIC0yMzUuODIsMzk2Ljg1IC0zNTMuNzEsNTk1LjI5Yy03LjMxLDEzLjQ2IC0xNS4wOSwyNi42NyAtMjMuNTcsMzkuNDNjLTcuNDUsMTAuOTYgLTE2LjQ5LDIxLjIzIC0yOC4xNCwyNy44M2MtMTMuNzMsNy45NCAtMzAuNjksMTEuMDkgLTQ2LjA4LDYuNTRjLTExLjIzLC0zLjQ3IC0yMi4wOSwtOS4xMiAtMzAuMTMsLTE3Ljg0Yy0xMC4xOCwtMTAuMDggLTE0LjY5LC0yNC44MyAtMTQuMTcsLTM4Ljk0YzAuNTIsLTE0Ljg2IDUuNDksLTI5LjM0IDEyLjk4LC00Mi4xYzcxLjU4LC0xMjEuNTkgMTQzLjYyLC0yNDIuOTIgMjE1LjkzLC0zNjQuMDljMzcuMiwtNjIuOCA3NC4yMywtMTI1LjY5IDExMS42NCwtMTg4LjM2YzM3Ljg0LC02My41IDc1Ljc3LC0xMjYuOTQgMTEzLjQ0LC0xOTAuNTRjMjEuMDIsLTM1LjgyIDQyLjE5LC03MS41NiA2NC4yOCwtMTA2Ljc0YzYuNzksLTExLjE1IDE1LjU4LC0yMS4xNSAyNi4xNiwtMjguODVjOC42OCwtNS45MiAxOC40MiwtMTEgMjkuMDUsLTExLjk0eiIgZmlsbD0iIzcwYzZiZSIvPgogIDwvZz4KICA8ZyBpZD0iIzFiYTBkOGZmIj4KICAgPHBhdGggaWQ9InN2Z18zIiBkPSJtNjI4LjM1LDYwOC4zOGMxNy44MywtMi44NyAzNi43MiwxLjM5IDUxLjUsMTEuNzhjMTEuMjIsOC42NiAxOS4wMSwyMS42NCAyMS4yNiwzNS42NWMxLjUzLDEwLjY4IDAuNDksMjEuNzUgLTMuNDQsMzEuODRjLTMuMDIsOC43MyAtNy4zNSwxNi45NCAtMTIuMTcsMjQuODFjLTY4Ljc2LDExNS41OCAtMTM3LjUsMjMxLjE3IC0yMDYuMjcsMzQ2Ljc1Yy04LjgsMTQuNDcgLTE2LjgyLDI5LjQ3IC0yNi45Niw0My4wN2MtNy4zNyw5LjExIC0xNi41OCwxNi44NSAtMjcuMjEsMjEuODljLTIyLjQ3LDExLjk3IC01MS43OSw0LjY3IC02OC44OCwtMTMuMzNjLTguNjYsLTguNjkgLTEzLjc0LC0yMC42MyAtMTQuNCwtMzIuODRjLTAuOTgsLTEyLjY0IDEuODEsLTI1LjQyIDcuNTMsLTM2LjY5YzUuMDMsLTEwLjk2IDEwLjk4LC0yMS40NSAxNy4xOSwtMzEuNzdjMzAuMjIsLTUwLjg0IDYwLjE3LC0xMDEuODQgOTAuMywtMTUyLjczYzQxLjI0LC02OS45OCA4My4xNiwtMTM5LjU1IDEyNC42NiwtMjA5LjM3YzQuNDEsLTcuOTQgOS45MSwtMTUuMjYgMTYuMDksLTIxLjljOC4zMywtOC40NiAxOC45LC0xNS4zIDMwLjgsLTE3LjE2eiIgZmlsbD0iIzFiYTBkOCIvPgogIDwvZz4KIDwvZz4KPC9zdmc+" width="50%" height="50%">'),H=e=>M(B,{get colorScheme(){return e.can?"success":"danger"},get children(){return e.children}}),X=()=>{const e=O();F("manage.sidemenu.profile");const{to:n,searchParams:K}=S(),[i,x]=I(L().username),[T,A]=I(""),[c,E]=m(t=>o.post("/me/update",{username:t?L().username:i(),password:t?"":T(),sso_id:L().sso_id})),g=async t=>{const s=await E(t);P(s,()=>{a({...L(),username:i()}),t?n(""):(R.success(e("users.update_profile_success")),n(`/@login?redirect=${encodeURIComponent(location.pathname)}`))})};function C(t){const s=t.data;s.sso_id&&(a({...L(),sso_id:s.sso_id}),g(!0))}return window.addEventListener("message",C),h(()=>{window.removeEventListener("message",C)}),M(b,{w:"$full",spacing:"$4",alignItems:"start",get children(){return[M(u,{get when(){return!N.is_guest(L())},get fallback(){return[M(Y,{status:"warning",flexDirection:{"@initial":"column","@lg":"row"},get children(){return[M(k,{mr:"$2_5"}),"//",M(w,{mr:"$2_5",get children(){return e("users.guest-tips")}}),M(w,{mr:"$2_5",get children(){return e("\u5DF2\u5173\u95ED")}}),M(p,{get children(){return e("users.modify_nothing")}})]}}),M(r,{spacing:"$2",get children(){return[M(y,{get children(){return e("global.have_account")}}),M(y,{color:"$info9",as:G,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return e("global.go_login")}}),W.cloneNode(!0)]}})]},get children(){return[M(D,{get children(){return e("users.update_profile")}}),M(Q,{gap:"$2",columns:{"@initial":1,"@md":2},get children(){return[M(z,{get children(){return[M(l,{for:"username",get children(){return e("users.change_username")}}),M(d,{id:"username",get value(){return i()},onInput:t=>{x(t.currentTarget.value)}})]}}),M(z,{get children(){return[M(l,{for:"password",get children(){return e("users.change_password")}}),M(d,{id:"password",type:"password",placeholder:"********",get value(){return T()},onInput:t=>{A(t.currentTarget.value)}}),M(U,{get children(){return e("users.change_password-tips")}})]}})]}}),M(r,{spacing:"$2",get children(){return[M(j,{get loading(){return c()},onClick:[g,!1],get children(){return e("global.save")}}),M(u,{get when(){return!L().otp},get children(){return M(j,{colorScheme:"accent",onClick:()=>{n("/@management/2fa")},get children(){return e("users.enable_2fa")}})}})]}})]}}),M(u,{get when(){return _(()=>!!f("sso_login_enabled"),!0)()&&!N.is_guest(L())},get children(){return[M(D,{get children(){return e("users.sso_login")}}),M(r,{spacing:"$2",get children(){return M(u,{get when(){return L().sso_id},get fallback(){return M(j,{onClick:()=>{const t=o.getUri()+"/auth/sso?method=get_sso_id";window.open(t,"authPopup","width=500,height=600")},get children(){return e("users.connect_sso")}})},get children(){return M(j,{colorScheme:"danger",get loading(){return c()},onClick:()=>{a({...L(),sso_id:""}),g(!0)},get children(){return e("users.disconnect_sso")}})}})}})]}}),M(r,{wrap:"wrap",gap:"$2",mt:"$2",get children(){return M(Z,{each:v,children:(t,s)=>M(H,{get can(){return N.can(L(),s())},get children(){return e(`users.permissions.${t}`)}})})}})]}})};export{X as default};
